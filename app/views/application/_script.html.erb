<script>
      
      

      (function ($) {

          const selectables = function(obj) {
              $(obj).append(`<div class="emoji-picker message-content">
                              <span class="close" id="close-emoji">&times;</span>
                              <div class="emoji-selectables">
                                  <span class="picker-emoji-sel emoji-smileys active" data-emoji="smileys">😀</span>
                                  <span class="picker-emoji-sel emoji-gestures" data-emoji="gestures">👌</span>
                                  <span class="picker-emoji-sel emoji-peoples" data-emoji="peoples">🧓</span>
                                  <span class="picker-emoji-sel emoji-symbos" data-emoji="symbos">❤️</span>
                                  <span class="picker-emoji-sel emoji-nature" data-emoji="nature">🍀</span>
                                  <span class="picker-emoji-sel emoji-food" data-emoji="food">🍌</span>
                                  <span class="picker-emoji-sel emoji-activity" data-emoji="activity">🏀</span>
                                  <span class="picker-emoji-sel emoji-travel" data-emoji="travel">✈️</span>

                                  </div>
                              <div class="emoji-content">
                                  <div id="emoji-smileys" class="picker-emoji active picker-emoji-content emoji-smileys"></div>
                                  <div id="emoji-gestures" class="picker-emoji picker-emoji-content emoji-gestures"></div>
                                  <div id="emoji-peoples" class="picker-emoji picker-emoji-content emoji-peoples"></div>
                                  <div id="emoji-symbos" class="picker-emoji picker-emoji-content emoji-symbos"></div>
                                  <div id="emoji-natures" class="picker-emoji picker-emoji-content emoji-nature"></div>
                                  <div id="emoji-foods" class="picker-emoji picker-emoji-content emoji-food"></div>
                                  <div id="emoji-activity" class="picker-emoji picker-emoji-content emoji-activity"></div>
                                  <div id="emoji-travel" class="picker-emoji picker-emoji-content emoji-travel"></div>
                                
                              </div>
                              <div>`);
              return this;
          }

          $.fn.disMojiPicker = function () {
              
              selectables(this);

              const smileys = "😀 😃 😄 😁 😆 😅 😂 🤣 ☺️ 😊 😇 🙂 🙃 😉 😌 😍 🥰 😘 😗 😙 😚 😋 😛 😝 😜 🤪 🤨 🧐 🤓 😎 🤩 🥳 😏 😒 😞 😔 😟 😕 🙁 ☹️ 😣 😖 😫 😩 🥺 😢 😭 😤 😠 😡 🤬 🤯 😳 🥵 🥶 😱 😨 😰 😥 😓 🤗 🤔 🤭 🤫 🤥 😶 😐 😑 😬 🙄 😯 😦 😧 😮 😲 🥱 😴 🤤 😪 😵 🤐 🥴 🤢 🤮 🤧 😷 🤒 🤕 🤑 🤠 😈 👿 👹 👺 🤡 💩 👻 💀 ☠️ 👽 👾 🤖 🎃 😺 😸 😹 😻 😼 😽 🙀 😿 😾".split(" ");
              const getures = "👋 🤚 🖐 ✋ 🖖 👌 🤏 ✌️ 🤞 🤟 🤘 🤙 👈 👉 👆 🖕 👇 ☝️ 👍 👎 ✊ 👊 🤛 🤜 👏 🙌 👐 🤲 🤝 🙏 ✍️ 💅 🤳 💪 🦾 🦵 🦿 🦶 👂 🦻 👃 🧠 🦷 🦴 👀 👁 👅 👄 💋 🩸".split(" ");
              const peoples = "👶 🧒 👦 👧 🧑 👱 👨 🧔 👨‍🦰 👨‍🦱 👨‍🦳 👨‍🦲 👩 👩‍🦰 🧑‍🦰 👩‍🦱 🧑‍🦱 👩‍🦳 🧑‍🦳 👩‍🦲 🧑‍🦲 👱‍♀️ 👱‍♂️ 🧓 👴 👵 🙍 🙍‍♂️ 🙍‍♀️ 🙎 🙎‍♂️ 🙎‍♀️ 🙅 🙅‍♂️ 🙅‍♀️ 🙆 🙆‍♂️ 🙆‍♀️ 💁 💁‍♂️ 💁‍♀️ 🙋 🙋‍♂️ 🙋‍♀️ 🧏 🧏‍♂️ 🧏‍♀️ 🙇 🙇‍♂️ 🙇‍♀️ 🤦 🤦‍♂️ 🤦‍♀️ 🤷 🤷‍♂️ 🤷‍♀️ 🧑‍⚕️ 👨‍⚕️ 👩‍⚕️ 🧑‍🎓 👨‍🎓 👩‍🎓 🧑‍🏫 👨‍🏫 👩‍🏫 🧑‍⚖️ 👨‍⚖️ 👩‍⚖️ 🧑‍🌾 👨‍🌾 👩‍🌾 🧑‍🍳 👨‍🍳 👩‍🍳 🧑‍🔧 👨‍🔧 👩‍🔧 🧑‍🏭 👨‍🏭 👩‍🏭 🧑‍💼 👨‍💼 👩‍💼 🧑‍🔬 👨‍🔬 👩‍🔬 🧑‍💻 👨‍💻 👩‍💻 🧑‍🎤 👨‍🎤 👩‍🎤 🧑‍🎨 👨‍🎨 👩‍🎨 🧑‍✈️ 👨‍✈️ 👩‍✈️ 🧑‍🚀 👨‍🚀 👩‍🚀 🧑‍🚒 👨‍🚒 👩‍🚒 👮 👮‍♂️ 👮‍♀️ 🕵 🕵️‍♂️ 🕵️‍♀️ 💂 💂‍♂️ 💂‍♀️ 👷 👷‍♂️ 👷‍♀️ 🤴 👸 👳 👳‍♂️ 👳‍♀️ 👲 🧕 🤵 👰 🤰 🤱 👼 🎅 🤶 🦸 🦸‍♂️ 🦸‍♀️ 🦹 🦹‍♂️ 🦹‍♀️ 🧙 🧙‍♂️ 🧙‍♀️ 🧚 🧚‍♂️ 🧚‍♀️ 🧛 🧛‍♂️ 🧛‍♀️ 🧜 🧜‍♂️ 🧜‍♀️ 🧝 🧝‍♂️ 🧝‍♀️ 🧞 🧞‍♂️ 🧞‍♀️ 🧟 🧟‍♂️ 🧟‍♀️ 💆 💆‍♂️ 💆‍♀️ 💇 💇‍♂️ 💇‍♀️ 🚶 🚶‍♂️ 🚶‍♀️ 🧍 🧍‍♂️ 🧍‍♀️ 🧎 🧎‍♂️ 🧎‍♀️ 🧑‍🦯 👨‍🦯 👩‍🦯 🧑‍🦼 👨‍🦼 👩‍🦼 🧑‍🦽 👨‍🦽 👩‍🦽 🏃 🏃‍♂️ 🏃‍♀️ 💃 🕺 🕴 👯 👯‍♂️ 👯‍♀️ 🧖 🧖‍♂️ 🧖‍♀️ 🧘 🧑‍🤝‍🧑 👭 👫 👬 💏 👨‍❤️‍💋‍👨 👩‍❤️‍💋‍👩 💑 👨‍❤️‍👨 👩‍❤️‍👩 👪 👨‍👩‍👦 👨‍👩‍👧 👨‍👩‍👧‍👦 👨‍👩‍👦‍👦 👨‍👩‍👧‍👧 👨‍👨‍👦 👨‍👨‍👧 👨‍👨‍👧‍👦 👨‍👨‍👦‍👦 👨‍👨‍👧‍👧 👩‍👩‍👦 👩‍👩‍👧 👩‍👩‍👧‍👦 👩‍👩‍👦‍👦 👩‍👩‍👧‍👧 👨‍👦 👨‍👦‍👦 👨‍👧 👨‍👧‍👦 👨‍👧‍👧 👩‍👦 👩‍👦‍👦 👩‍👧 👩‍👧‍👦 👩‍👧‍👧 🗣 👤 👥 👣".split(" ")
              const natures = "🐶 🐱 🐭 🐹 🐰 🦊 🐻 🐼 🐨 🐯 🦁 🐮 🐷 🐽 🐸 🐵 🙈 🙉 🙊 🐒 🐔 🐧 🐦 🐤 🐣 🐥 🦆 🦅 🦉 🦇 🐺 🐗 🐴 🦄 🐝 🐛 🦋 🐌 🐞 🐜 🦟 🦗 🕷 🕸 🦂 🐢 🐍 🦎 🦖 🦕 🐙 🦑 🦐 🦞 🦀 🐡 🐠 🐟 🐬 🐳 🐋 🦈 🐊 🐅 🐆 🦓 🦍 🦧 🐘 🦛 🦏 🐪 🐫 🦒 🦘 🐃 🐂 🐄 🐎 🐖 🐏 🐑 🦙 🐐 🦌 🐕 🐩 🦮 🐕‍🦺 🐈 🐓 🦃 🦚 🦜 🦢 🦩 🕊 🐇 🦝 🦨 🦡 🦦 🦥 🐁 🐀 🐿 🦔 🐾 🐉 🐲 🌵 🎄 🌲 🌳 🌴 🌱 🌿 ☘️ 🍀 🎍 🎋 🍃 🍂 🍁 🍄 🐚 🌾 💐 🌷 🌹 🥀 🌺 🌸 🌼 🌻 🌞 🌝 🌛 🌜 🌚 🌕 🌖 🌗 🌘 🌑 🌒 🌓 🌔 🌙 🌎 🌍 🌏 🪐 💫 ⭐️ 🌟 ✨ ⚡️ ☄️ 💥 🔥 🌪 🌈 ☀️ 🌤 ⛅️ 🌥 ☁️ 🌦 🌧 ⛈ 🌩 🌨 ❄️ ☃️ ⛄️ 🌬 💨 💧 💦 ☔️ ☂️ 🌊 🌫".split(" ");
              const foods = "🍏 🍎 🍐 🍊 🍋 🍌 🍉 🍇 🍓 🍈 🍒 🍑 🥭 🍍 🥥 🥝 🍅 🍆 🥑 🥦 🥬 🥒 🌶 🌽 🥕 🧄 🧅 🥔 🍠 🥐 🥯 🍞 🥖 🥨 🧀 🥚 🍳 🧈 🥞 🧇 🥓 🥩 🍗 🍖 🦴 🌭 🍔 🍟 🍕 🥪 🥙 🧆 🌮 🌯 🥗 🥘 🥫 🍝 🍜 🍲 🍛 🍣 🍱 🥟 🦪 🍤 🍙 🍚 🍘 🍥 🥠 🥮 🍢 🍡 🍧 🍨 🍦 🥧 🧁 🍰 🎂 🍮 🍭 🍬 🍫 🍿 🍩 🍪 🌰 🥜 🍯 🥛 🍼 ☕️ 🍵 🧃 🥤 🍶 🍺 🍻 🥂 🍷 🥃 🍸 🍹 🧉 🍾 🧊 🥄 🍴 🍽 🥣 🥡 🥢 🧂".split(" ");
              const activitys = "⚽️ 🏀 🏈 ⚾️ 🥎 🎾 🏐 🏉 🥏 🎱 🪀 🏓 🏸 🏒 🏑 🥍 🏏 🥅 ⛳️ 🪁 🏹 🎣 🤿 🥊 🥋 🎽 🛹 🛷 ⛸ 🥌 🎿 ⛷ 🏂 🪂 🏋️ 🏋️‍♂️ 🏋️‍♀️ 🤼 🤼‍♂️ 🤼‍♀️ 🤸‍♀️ 🤸 🤸‍♂️ ⛹️ ⛹️‍♂️ ⛹️‍♀️ 🤺 🤾 🤾‍♂️ 🤾‍♀️ 🏌️ 🏌️‍♂️ 🏌️‍♀️ 🏇 🧘 🧘‍♂️ 🧘‍♀️ 🏄 🏄‍♂️ 🏄‍♀️ 🏊 🏊‍♂️ 🏊‍♀️ 🤽 🤽‍♂️ 🤽‍♀️ 🚣 🚣‍♂️ 🚣‍♀️ 🧗 🧗‍♂️ 🧗‍♀️ 🚵 🚵‍♂️ 🚵‍♀️ 🚴 🚴‍♂️ 🚴‍♀️ 🏆 🥇 🥈 🥉 🏅 🎖 🏵 🎗 🎫 🎟 🎪 🤹 🤹‍♂️ 🤹‍♀️ 🎭 🩰 🎨 🎬 🎤 🎧 🎼 🎹 🥁 🎷 🎺 🎸 🪕 🎻 🎲 ♟ 🎯 🎳 🎮 🎰 🧩".split(" ");
              const travels = "🚗 🚕 🚙 🚌 🚎 🏎 🚓 🚑 🚒 🚐 🚚 🚛 🚜 🦯 🦽 🦼 🛴 🚲 🛵 🏍 🛺 🚨 🚔 🚍 🚘 🚖 🚡 🚠 🚟 🚃 🚋 🚞 🚝 🚄 🚅 🚈 🚂 🚆 🚇 🚊 🚉 ✈️ 🛫 🛬 🛩 💺 🛰 🚀 🛸 🚁 🛶 ⛵️ 🚤 🛥 🛳 ⛴ 🚢 ⚓️ ⛽️ 🚧 🚦 🚥 🚏 🗺 🗿 🗽 🗼 🏰 🏯 🏟 🎡 🎢 🎠 ⛲️ ⛱ 🏖 🏝 🏜 🌋 ⛰ 🏔 🗻 🏕 ⛺️ 🏠 🏡 🏘 🏚 🏗 🏭 🏢 🏬 🏣 🏤 🏥 🏦 🏨 🏪 🏫 🏩 💒 🏛 ⛪️ 🕌 🕍 🛕 🕋 ⛩ 🛤 🛣 🗾 🎑 🏞 🌅 🌄 🌠 🎇 🎆 🌇 🌆 🏙 🌃 🌌 🌉 🌁".split(" ");
              const symbos = "❤️ 🧡 💛 💚 💙 💜 🖤 🤍 🤎 💔 ❣️ 💕 💞 💓 💗 💖 💘 💝 💟 ☮️ ✝️ ☪️ 🕉 ☸️ ✡️ 🔯 🕎 ☯️ ☦️ 🛐 ⛎ ♈️ ♉️ ♊️ ♋️ ♌️ ♍️ ♎️ ♏️ ♐️ ♑️ ♒️ ♓️ 🆔 ⚛️ 🉑 ☢️ ☣️ 📴 📳 🈶 🈚️ 🈸 🈺 🈷️ ✴️ 🆚 💮 🉐 ㊙️ ㊗️ 🈴 🈵 🈹 🈲 🅰️ 🅱️ 🆎 🆑 🅾️ 🆘 ❌ ⭕️ 🛑 ⛔️ 📛 🚫 💯 💢 ♨️ 🚷 🚯 🚳 🚱 🔞 📵 🚭 ❗️ ❕ ❓ ❔ ‼️ ⁉️ 🔅 🔆 〽️ ⚠️ 🚸 🔱 ⚜️ 🔰 ♻️ ✅ 🈯️ 💹 ❇️ ✳️ ❎ 🌐 💠 Ⓜ️ 🌀 💤 🏧 🚾 ♿️ 🅿️ 🈳 🈂️ 🛂 🛃 🛄 🛅 🚹 🚺 🚼 🚻 🚮 🎦 📶 🈁 🔣 ℹ️ 🔤 🔡 🔠 🆖 🆗 🆙 🆒 🆕 🆓 0️⃣ 1️⃣ 2️⃣ 3️⃣ 4️⃣ 5️⃣ 6️⃣ 7️⃣ 8️⃣ 9️⃣ 🔟 🔢 #️⃣ *️⃣ ⏏️ ▶️ ⏸ ⏯ ⏹ ⏺ ⏭ ⏮ ⏩ ⏪ ⏫ ⏬ ◀️ 🔼 🔽 ➡️ ⬅️ ⬆️ ⬇️ ↗️ ↘️ ↙️ ↖️ ↕️ ↔️ ↪️ ↩️ ⤴️ ⤵️ 🔀 🔁 🔂 🔄 🔃 🎵 🎶 ➕ ➖ ➗ ✖️ ♾ 💲 💱 ™️ ©️ ®️ 〰️ ➰ ➿ 🔚 🔙 🔛 🔝 🔜 ✔️ ☑️ 🔘 🔴 🟠 🟡 🟢 🔵 🟣 ⚫️ ⚪️ 🟤 🔺 🔻 🔸 🔹 🔶 🔷 🔳 🔲 ▪️ ▫️ ◾️ ◽️ ◼️ ◻️ 🟥 🟧 🟨 🟩 🟦 🟪 ⬛️ ⬜️ 🟫 🔈 🔇 🔉 🔊 🔔 🔕 📣 📢 👁‍🗨 💬 💭 🗯 ♠️ ♣️ ♥️ ♦️ 🃏 🎴 🀄️ 🕐 🕑 🕒 🕓 🕔 🕕 🕖 🕗 🕘 🕙 🕚 🕛 🕜 🕝 🕞 🕟 🕠 🕡 🕢 🕣 🕤 🕥 🕦 🕧".split(" ");

              
              smileys.map(emoji => $('#emoji-smileys').append(`<span>${emoji}</span>`));
              natures.map(emoji => $('#emoji-natures').append(`<span>${emoji}</span>`));
              getures.map(emoji => $('#emoji-gestures').append(`<span>${emoji}</span>`));
              foods.map(emoji => $('#emoji-foods').append(`<span>${emoji}</span>`));
              activitys.map(emoji => $('#emoji-activity').append(`<span>${emoji}</span>`));
              travels.map(emoji => $('#emoji-travel').append(`<span>${emoji}</span>`));
              peoples.map(emoji => $('#emoji-peoples').append(`<span>${emoji}</span>`));
              symbos.map(emoji => $('#emoji-symbos').append(`<span>${emoji}</span>`));

              $('.emoji-selectables span').click(function() {
                  $(`.picker-emoji-sel`).removeClass('active')
                  $(`.picker-emoji`).removeClass('active');
                  $(`.emoji-${$(this)[0].dataset.emoji}`).addClass('active');
                  $(`.picker-emoji-sel.emoji-${$(this)[0].dataset.emoji}`).addClass('active');
              });

              return this;
          }

        $.fn.picker = function(emoji) {
            $('.picker-emoji-content span').click(function(e) {
                  quantity += 1;
                  var letter = $(this).text();
                  // var value = $($(this).children()).val() + letter;
                  // emoji(value.substring(9)); 
                  emoji(letter);
            })
        }


      })(jQuery);

      var txtField = document.getElementById("textField");
      var emojiPick = document.getElementById("emojis");
      var quantity = 0;
      var pos = [];
      

      function positionEmojiPicker() {
        // const launchButton = document.getElementById("textField");
        const txtFieldRec = txtField.getBoundingClientRect();
        var txtFieldBottom = txtFieldRec.bottom;
        console.log(txtFieldBottom)
        // txtFieldBottom
        // emojiPick.style.top = `${txtFieldBottom}px`
      }
      

      $("#emojis").disMojiPicker();
      // twemoji.parse(document.body);

      $("#emojis").picker(
        emoji => { 
          var editField = $("#textField");
          var content = $("#textField").val()
          var position = document.getElementById("textField").editor.getPosition()
          position += 5
          var newContent = content.substr(0, position) + emoji + content.substr(position);
          // editField.val(editField.val() + emoji);
          $("#textField").val(newContent)
          document.getElementById("textField").editor.setSelectedRange(pos[0] + quantity * 2);
          editField.focus();
         }
      );

      
      // var elements = document.getElementsByClassName("message-content");
      // for (var i = 0; i < elements.length; i++) {
      //   var element = elements[i];
      //   twemoji.parse(element);
      // }

      
      $(document).ready(function(){
        

        
        const editor = document.getElementById("textField").editor;
        

        $("#showEmoji").click(function(){
          // var posish = f1(document.getElementById('textField'))
          const selector = document.getElementById("emojis");
          console.log(editor.getPosition());
          if ($("#emojis").is(":hidden")) {
            var position = editor.getPosition();
            pos.push(position);
            positionEmojiPicker();
            $("#emojis").show();
          } else {
            $("#emojis").hide();
            $("#textField").focus();
            editor.setSelectedRange(pos[0] + quantity * 2);
            console.log("quantity", quantity);
            pos = [];
            quantity = 0;
          }
        });



        // $("#showEmoji").click(function(){
        //   // var posish = f1(document.getElementById('textField'))
        //   const selector = document.getElementById("emojis");
        //   console.log(editor.getPosition());
        //   if ($("#emojis").is(":hidden")) {
        //     var position = editor.getPosition();
        //     pos.push(position);
        //     positionEmojiPicker();
        //     $("#emojis").show();
        //   } else {
        //     $("#emojis").hide();
        //     $("#textField").focus();
        //     editor.setSelectedRange(pos[0] + quantity * 2);
        //     console.log("quantity", quantity);
        //     pos = [];
        //     quantity = 0;
        //   }
        // });


        $('#send-button').click(function() {
          $("#emojis").hide();
        });


        $('#close-emoji').click(function() {
          $('#emojis').hide();
          $("#emojis").hide();
          $("#textField").focus();
          editor.setSelectedRange(pos[0] + quantity * 2);
          console.log("quantity", quantity);
          pos = [];
          quantity = 0;
        });


        positionEmojiPicker();


      });

      $(window).resize(function() {
        positionEmojiPicker();
      });

      

    </script>